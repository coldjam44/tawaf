<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\Project;
use App\Models\ProjectDetail;
use App\Models\ProjectDescription;
use App\Models\ProjectAmenity;
use App\Models\ProjectContentBlock;
use App\Models\ProjectImage;
use App\Models\Area;
use App\Models\Developer;
use App\Models\RealEstateCompany;
use Illuminate\Support\Facades\Http;

class SingleSaadiyatProjectSeeder extends Seeder
{
    public function run(): void
    {
        // Get Saadiyat Island area
        $saadiyatArea = Area::where('slug', 'saadiyat-island')->first();
        if (!$saadiyatArea) {
            $this->command->error('Saadiyat Island area not found!');
            return;
        }

        // Get or create developer
        $developer = Developer::firstOrCreate(
            ['name_en' => 'Aldar Properties'],
            [
                'name_ar' => 'ุฃูุฏุงุฑ ุงูุนูุงุฑูุฉ',
                'email' => 'info@aldar.com',
                'phone' => '+971 2 810 5555'
            ]
        );

        // Get or create company
        $company = RealEstateCompany::firstOrCreate(
            ['company_name_en' => 'Aldar Real Estate'],
            [
                'company_name_ar' => 'ุฃูุฏุงุฑ ุงูุนูุงุฑูุฉ',
                'contact_number' => '+971 2 810 5555',
                'short_description_en' => 'Leading real estate development company in Abu Dhabi',
                'short_description_ar' => 'ุดุฑูุฉ ุฑุงุฆุฏุฉ ูู ุงูุชุทููุฑ ุงูุนูุงุฑู ูู ุฃุจูุธุจู'
            ]
        );

        // Create single comprehensive project
        $project = Project::create([
            'prj_areaId' => $saadiyatArea->id,
            'company_id' => $company->id,
            'prj_title_ar' => 'ุณุนุฏูุงุช ุฑูุฒูุฑุช',
            'prj_title_en' => 'Saadiyat Resort',
            'prj_description_ar' => 'ูุดุฑูุน ุณููู ูุงุฎุฑ ูู ุฌุฒูุฑุฉ ุงูุณุนุฏูุงุช ูุชููุฒ ุจุฅุทูุงูุงุช ุจุญุฑูุฉ ุฎูุงุจุฉ ููุฑุงูู ุนุงูููุฉ ุงููุณุชูู. ูููุฑ ุงููุดุฑูุน ุฃุณููุจ ุญูุงุฉ ุฑุงูู ูุน ุชุตุงููู ูุนูุงุฑูุฉ ูุจุชูุฑุฉ ููุฑุงูู ูุชุทูุฑุฉ ุชูุงุฆู ุฃููุงุท ุงูุญูุงุฉ ุงูุญุฏูุซุฉ.',
            'prj_description_en' => 'A luxury residential project on Saadiyat Island featuring stunning sea views and world-class amenities. The project offers an elegant lifestyle with innovative architectural designs and modern facilities that suit contemporary living patterns.',
            'prj_projectNumber' => 'SAAD-2025-001',
            'prj_MadhmounPermitNumber' => 'PERMIT-SAAD-2025-001',
            'is_sent_to_bot' => false
        ]);

        $this->command->info("โ Created project: {$project->prj_title_en}");

        // Add comprehensive project details
        $this->addProjectDetails($project);
        
        // Add project descriptions
        $this->addProjectDescriptions($project);
        
        // Add project amenities
        $this->addProjectAmenities($project);
        
        // Add project content blocks
        $this->addProjectContentBlocks($project);
        
        // Add project images with actual downloads
        $this->addProjectImages($project);
        
        $this->command->info('๐ Single Saadiyat Project seeder completed successfully!');
    }

    private function addProjectDetails($project)
    {
        $details = [
            [
                'detail_ar' => 'ุงูุณุนุฑ ุงุจุชุฏุงุกู ูู',
                'detail_en' => 'Starting Price',
                'detail_value_ar' => '1,500,000 ุฏุฑูู',
                'detail_value_en' => 'AED 1,500,000',
                'order' => 1
            ],
            [
                'detail_ar' => 'ููุน ุงูุนุฑุถ',
                'detail_en' => 'Offering Type',
                'detail_value_ar' => 'ููุจูุน',
                'detail_value_en' => 'For Sale',
                'order' => 2
            ],
            [
                'detail_ar' => 'ููุน ุงูุนูุงุฑ',
                'detail_en' => 'Property Type',
                'detail_value_ar' => 'ุดูู ูููู ูุชุงูู ูุงูุณ',
                'detail_value_en' => 'Apartments, Villas & Townhouses',
                'order' => 3
            ],
            [
                'detail_ar' => 'ุนุฏุฏ ุงูุบุฑู',
                'detail_en' => 'Bedrooms',
                'detail_value_ar' => '1 ุฅูู 5 ุบุฑู ููู',
                'detail_value_en' => '1 to 5 Bedrooms',
                'order' => 4
            ],
            [
                'detail_ar' => 'ุฎุทุฉ ุงูุณุฏุงุฏ',
                'detail_en' => 'Payment Plan',
                'detail_value_ar' => '40/60',
                'detail_value_en' => '40/60',
                'order' => 5
            ],
            [
                'detail_ar' => 'ุงูุชุณููู',
                'detail_en' => 'Handover',
                'detail_value_ar' => 'ุงูุฑุจุน 3 ูู ุนุงู 2025',
                'detail_value_en' => 'Q3 2025',
                'order' => 6
            ],
            [
                'detail_ar' => 'ูุณุจุฉ ุงูุฅูุฌุงุฒ',
                'detail_en' => 'Progress',
                'detail_value_ar' => 'ููุฏ ุงูุฅูุดุงุก',
                'detail_value_en' => 'Under Construction',
                'order' => 7
            ],
            [
                'detail_ar' => 'ุงููุณุงุญุฉ',
                'detail_en' => 'Area',
                'detail_value_ar' => '800 - 3,500 ูุฏู ูุฑุจุน',
                'detail_value_en' => '800 - 3,500 sq ft',
                'order' => 8
            ],
            [
                'detail_ar' => 'ุงููุทูุฑ',
                'detail_en' => 'Developer',
                'detail_value_ar' => 'ุฃูุฏุงุฑ ุงูุนูุงุฑูุฉ',
                'detail_value_en' => 'Aldar Properties',
                'order' => 9
            ],
            [
                'detail_ar' => 'ุงููููุน',
                'detail_en' => 'Location',
                'detail_value_ar' => 'ุฌุฒูุฑุฉ ุงูุณุนุฏูุงุชุ ุฃุจูุธุจู',
                'detail_value_en' => 'Saadiyat Island, Abu Dhabi',
                'order' => 10
            ]
        ];

        foreach ($details as $detail) {
            ProjectDetail::create([
                'project_id' => $project->id,
                'detail_ar' => $detail['detail_ar'],
                'detail_en' => $detail['detail_en'],
                'detail_value_ar' => $detail['detail_value_ar'],
                'detail_value_en' => $detail['detail_value_en'],
                'order' => $detail['order']
            ]);
        }

        $this->command->info("โ Added " . count($details) . " project details");
    }

    private function addProjectDescriptions($project)
    {
        $descriptions = [
            [
                'section_type' => 'about',
                'title_ar' => 'ุญูู ุงููุดุฑูุน',
                'title_en' => 'About the Project',
                'content_ar' => 'ุณุนุฏูุงุช ุฑูุฒูุฑุช ูู ูุดุฑูุน ุณููู ูุงุฎุฑ ููุน ูู ููุจ ุฌุฒูุฑุฉ ุงูุณุนุฏูุงุชุ ุฃุญุฏ ุฃูุซุฑ ุงูููุงุทู ุญูููุฉ ูู ุฃุจูุธุจู. ูุชููุฒ ุงููุดุฑูุน ุจุฅุทูุงูุงุช ุจุญุฑูุฉ ุฎูุงุจุฉ ููุฑุงูู ุนุงูููุฉ ุงููุณุชููุ ููุง ูููุฑ ุฃุณููุจ ุญูุงุฉ ุฑุงูู ููุชููุฒ ููุณูุงู.',
                'content_en' => 'Saadiyat Resort is a luxury residential project located in the heart of Saadiyat Island, one of the most vibrant areas in Abu Dhabi. The project features stunning sea views and world-class amenities, providing an elegant and distinguished lifestyle for residents.',
                'order_index' => 1
            ],
            [
                'section_type' => 'architecture',
                'title_ar' => 'ุงูุชุตููู ุงููุนูุงุฑู',
                'title_en' => 'Architecture',
                'content_ar' => 'ูุชููุฒ ุงููุดุฑูุน ุจุชุตุงููู ูุนูุงุฑูุฉ ุนุตุฑูุฉ ุชุฌูุน ุจูู ุงูุฃูุงูุฉ ูุงููุธุงุฆููุฉ. ุชู ุชุตููู ุงููุญุฏุงุช ุงูุณูููุฉ ุจุนูุงูุฉ ูุงุฆูุฉ ูุชูููุฑ ุฃูุตู ุฏุฑุฌุงุช ุงูุฑุงุญุฉ ูุงูุฎุตูุตูุฉ ูุน ุงูุงุณุชูุงุฏุฉ ูู ุงูุฅุทูุงูุงุช ุงูุจุญุฑูุฉ ุงูุฎูุงุจุฉ ูุงูุทุจูุนุฉ ุงูุฎุถุฑุงุก ุงููุญูุทุฉ.',
                'content_en' => 'The project features contemporary architectural designs that combine elegance and functionality. Residential units are carefully designed to provide maximum comfort and privacy while taking advantage of stunning sea views and surrounding greenery.',
                'order_index' => 2
            ],
            [
                'section_type' => 'why_choose',
                'title_ar' => 'ููุงุฐุง ุชุฎุชุงุฑ ุณุนุฏูุงุช ุฑูุฒูุฑุชุ',
                'title_en' => 'Why Choose Saadiyat Resort?',
                'content_ar' => 'ูููุน ุงุณุชุฑุงุชูุฌู ูู ุฌุฒูุฑุฉ ุงูุณุนุฏูุงุชุ ูุฑุงูู ุชุฑููููุฉ ูุชูุงููุฉุ ุชุตุงููู ุนุตุฑูุฉุ ุฎุทุท ุฏูุน ูุฑูุฉุ ููุทูุฑ ููุซูู ูุน ุณุฌู ุญุงูู ูู ุงูุชุทููุฑ ุงูุนูุงุฑู ุงููุงุฎุฑ. ุจุงูุฅุถุงูุฉ ุฅูู ูุฑุจ ุงููุดุฑูุน ูู ุงูุดูุงุทุฆ ูุงููุฑุงูู ุงูุณูุงุญูุฉ.',
                'content_en' => 'Strategic location on Saadiyat Island, integrated recreational facilities, contemporary designs, flexible payment plans, and a trusted developer with a proven track record in luxury real estate development. Plus proximity to beaches and tourist facilities.',
                'order_index' => 3
            ],
            [
                'section_type' => 'location',
                'title_ar' => 'ุงููููุน ูุงููุตูููุฉ',
                'title_en' => 'Location & Accessibility',
                'content_ar' => 'ููุน ุงููุดุฑูุน ูู ุฌุฒูุฑุฉ ุงูุณุนุฏูุงุชุ ุฃุญุฏ ุฃูุซุฑ ุงูููุงุทู ุญูููุฉ ูู ุฃุจูุธุจู. ูุชููุฒ ุงููููุน ุจูุฑุจู ูู ุงูุดูุงุทุฆ ูุงููุฑุงูู ุงูุชุฑููููุฉ ูุงููุคุณุณุงุช ุงูุชุนููููุฉ ูุงูุทุจูุฉ. ููุง ูุณูู ุงููุตูู ุฅููู ุนุจุฑ ุดุจูุฉ ููุงุตูุงุช ูุชุทูุฑุฉ.',
                'content_en' => 'The project is located on Saadiyat Island, one of the most vibrant areas in Abu Dhabi. The location is distinguished by its proximity to beaches, recreational facilities, educational and medical institutions. It is also easily accessible through an advanced transportation network.',
                'order_index' => 4
            ],
            [
                'section_type' => 'investment',
                'title_ar' => 'ูุฑุต ุงูุงุณุชุซูุงุฑ',
                'title_en' => 'Investment Opportunities',
                'content_ar' => 'ุฌุฒูุฑุฉ ุงูุณุนุฏูุงุช ุชุนุฏ ูู ุฃูุถู ุงูููุงุทู ููุงุณุชุซูุงุฑ ุงูุนูุงุฑู ูู ุฃุจูุธุจู ูุน ุฅููุงููุฉ ุชุญููู ุนูุงุฆุฏ ุงุณุชุซูุงุฑูุฉ ููุชุงุฒุฉ. ุงููุดุฑูุน ูููุฑ ูุฑุตุฉ ุงุณุชุซูุงุฑูุฉ ูุฑูุฏุฉ ูู ูููุน ูุชููุฒ ูุน ุฅููุงููุฉ ููู ูููุฉ ูู ุงููููุฉ ุงูุนูุงุฑูุฉ.',
                'content_en' => 'Saadiyat Island is one of the best areas for real estate investment in Abu Dhabi with the potential for excellent investment returns. The project provides a unique investment opportunity in a prime location with strong potential for real estate value growth.',
                'order_index' => 5
            ]
        ];

        foreach ($descriptions as $description) {
            ProjectDescription::create([
                'project_id' => $project->id,
                'section_type' => $description['section_type'],
                'title_ar' => $description['title_ar'],
                'title_en' => $description['title_en'],
                'content_ar' => $description['content_ar'],
                'content_en' => $description['content_en'],
                'order_index' => $description['order_index']
            ]);
        }

        $this->command->info("โ Added project descriptions");
    }

    private function addProjectAmenities($project)
    {
        $amenities = [
            'infinity_pool',
            'concierge_services',
            'retail_fnb',
            'bbq_area',
            'cinema_game_room',
            'gym',
            'wellness_facilities',
            'splash_pad',
            'sauna_wellness',
            'multipurpose_court'
        ];

        foreach ($amenities as $amenity) {
            ProjectAmenity::create([
                'project_id' => $project->id,
                'amenity_type' => $amenity,
                'is_active' => true
            ]);
        }

        $this->command->info("โ Added project amenities");
    }

    private function addProjectContentBlocks($project)
    {
        $contentBlocks = [
            [
                'title_ar' => 'ุงููุฑุงูู ุงูุชุฑููููุฉ',
                'title_en' => 'Recreational Facilities',
                'content_ar' => 'ูุถู ุงููุดุฑูุน ูุฌููุนุฉ ูุชููุนุฉ ูู ุงููุฑุงูู ุงูุชุฑููููุฉ ุงูุชู ุชูุจู ุฌููุน ุงุญุชูุงุฌุงุช ุงูุณูุงูุ ุจูุง ูู ุฐูู ุญูุงูุงุช ุงูุณุจุงุญุฉ ุงููุงููุงุฆูุฉุ ุตุงูุฉ ุงูุฃูุนุงุจ ุงูุฑูุงุถูุฉ ุงููุชุทูุฑุฉุ ููุงุทู ุงูุดูุงุก ุงููุฎุตุตุฉุ ูุตุงูุฉ ุงูุณูููุง ูุงูุฃูุนุงุจ.',
                'content_en' => 'The project includes a variety of recreational facilities that meet all residents\' needs, including infinity swimming pools, advanced gym, dedicated BBQ areas, and cinema and games hall.',
                'order' => 1
            ],
            [
                'title_ar' => 'ุงูุฎุฏูุงุช ุงููุชุงุญุฉ',
                'title_en' => 'Available Services',
                'content_ar' => 'ูููุฑ ุงููุดุฑูุน ุฎุฏูุงุช ูุชูุงููุฉ ุชุดูู ุฎุฏูุฉ ุงููููุณูุฑุฌ ุนูู ูุฏุงุฑ ุงูุณุงุนุฉุ ุงูุฃูู ุงููุชูุฏูุ ุงูุตูุงูุฉ ุงูุฏูุฑูุฉุ ูุงูุชูุธูู. ููุง ูุชุถูู ูุฑุงูุฒ ุชุฌุงุฑูุฉ ููุทุงุนู ูุชููุนุฉ ูุชูุจูุฉ ุงุญุชูุงุฌุงุช ุงูุณูุงู ุงูููููุฉ.',
                'content_en' => 'The project provides integrated services including 24/7 concierge service, advanced security, regular maintenance, and cleaning. It also includes commercial centers and diverse restaurants to meet residents\' daily needs.',
                'order' => 2
            ],
            [
                'title_ar' => 'ุงูููุงุตูุงุช ูุงููุตูููุฉ',
                'title_en' => 'Transportation & Accessibility',
                'content_ar' => 'ูุชููุฒ ุงููููุน ุจุณูููุฉ ุงููุตูู ุฅููู ุนุจุฑ ุดุจูุฉ ููุงุตูุงุช ูุชุทูุฑุฉ ุชุฑุจุทู ุจุฌููุน ุฃูุญุงุก ุฃุจูุธุจู. ููุง ููุน ุจุงููุฑุจ ูู ุงููุทุงุฑ ุงูุฏููู ูุงูููุงูุฆ ุงูุจุญุฑูุฉุ ููุง ูุฌุนูู ูุซุงูู ููุงุณุชุซูุงุฑ ูุงูุณูุงุญุฉ.',
                'content_en' => 'The location is distinguished by easy access through an advanced transportation network that connects it to all parts of Abu Dhabi. It is also located near the international airport and seaports, making it ideal for investment and tourism.',
                'order' => 3
            ],
            [
                'title_ar' => 'ุงููุฑุงูู ุงูุตุญูุฉ ูุงูุฑูุงุถูุฉ',
                'title_en' => 'Health & Sports Facilities',
                'content_ar' => 'ูุญุชูู ุงููุดุฑูุน ุนูู ูุฑุงูู ุตุญูุฉ ูุฑูุงุถูุฉ ูุชุทูุฑุฉ ุชุดูู ูุฑูุฒ ุงูููุงูุฉ ุงูุจุฏููุฉุ ุงูุณุงููุงุ ูุฑุงูู ุงูุนุงููุฉุ ูููุทูุฉ ุงูุฃูุนุงุจ ุงููุงุฆูุฉ. ููุง ูููุฑ ูุณุงุญุงุช ุฎุถุฑุงุก ูุงุณุนุฉ ููุงุณุชุฑุฎุงุก ูุงูุชูุชุน ุจุงูุทุจูุนุฉ.',
                'content_en' => 'The project includes advanced health and sports facilities including fitness center, sauna, wellness facilities, and splash pad. It also provides extensive green spaces for relaxation and enjoying nature.',
                'order' => 4
            ]
        ];

        foreach ($contentBlocks as $block) {
            ProjectContentBlock::create([
                'project_id' => $project->id,
                'title_ar' => $block['title_ar'],
                'title_en' => $block['title_en'],
                'content_ar' => $block['content_ar'],
                'content_en' => $block['content_en'],
                'order' => $block['order'],
                'is_active' => true
            ]);
        }

        $this->command->info("โ Added project content blocks");
    }

    private function addProjectImages($project)
    {
        $imageTypes = [
            'exterior' => [
                'https://images.unsplash.com/photo-1542314831-068cd1dbfeeb?w=1200&h=800&fit=crop&q=80',
                'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?w=1200&h=800&fit=crop&q=80',
                'https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=1200&h=800&fit=crop&q=80'
            ],
            'interior' => [
                'https://images.unsplash.com/photo-1570129477492-45c003edd2be?w=1200&h=800&fit=crop&q=80',
                'https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?w=1200&h=800&fit=crop&q=80',
                'https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=1200&h=800&fit=crop&q=80'
            ],
            'featured' => [
                'https://images.unsplash.com/photo-1542314831-068cd1dbfeeb?w=1200&h=800&fit=crop&q=80',
                'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?w=1200&h=800&fit=crop&q=80'
            ]
        ];

        $projectsDir = public_path('projects/images');
        if (!file_exists($projectsDir)) {
            mkdir($projectsDir, 0755, true);
        }

        $order = 1;
        foreach ($imageTypes as $type => $urls) {
            foreach ($urls as $index => $url) {
                try {
                    $imageContent = Http::timeout(30)->get($url);
                    
                    if ($imageContent->successful()) {
                        $imageName = 'saadiyat_resort_' . $type . '_' . ($index + 1) . '_' . time() . '.jpg';
                        $imagePath = $projectsDir . '/' . $imageName;
                        file_put_contents($imagePath, $imageContent->body());
                        
                        // Create project image record
                        ProjectImage::create([
                            'project_id' => $project->id,
                            'type' => $type,
                            'image_path' => $imageName,
                            'is_featured' => $index === 0,
                            'order' => $order++,
                            'title_ar' => 'ุตูุฑุฉ ' . $type . ' ' . ($index + 1),
                            'title_en' => ucfirst($type) . ' Image ' . ($index + 1),
                            'description_ar' => 'ุตูุฑุฉ ' . $type . ' ููุดุฑูุน ุณุนุฏูุงุช ุฑูุฒูุฑุช',
                            'description_en' => ucfirst($type) . ' image for Saadiyat Resort project'
                        ]);
                        
                        $this->command->info("โ Downloaded and added {$type} image: {$imageName}");
                    }
                } catch (\Exception $e) {
                    $this->command->error("โ Failed to download image for {$project->prj_title_en}: " . $e->getMessage());
                }
            }
        }
    }
}
